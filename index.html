<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shiller vs Gold - Historical Market Valuation</title>
    <meta name="description" content="Interactive visualization of CAPE ratio, home prices, S&P 500, and gold prices. Explore historical market valuations around major economic events from 1871 to present.">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="icon" type="image/png" href="preview.png">

    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Shiller vs Gold - Historical Market Valuation">
    <meta property="og:description" content="Interactive visualization of CAPE ratio, home prices, S&P 500, and gold prices. Explore historical market valuations around major economic events.">
    <meta property="og:image" content="https://posix4e.github.io/shillervsgold/preview.png">
    <meta property="og:url" content="https://posix4e.github.io/shillervsgold/">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Shiller vs Gold - Historical Market Valuation">
    <meta name="twitter:description" content="Interactive visualization of CAPE ratio, home prices, S&P 500, and gold prices since 1871.">
    <meta name="twitter:image" content="https://posix4e.github.io/shillervsgold/preview.png">

    <!-- Stylesheets and Scripts -->
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1/dist/chartjs-plugin-annotation.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Shiller vs Gold</h1>
            <p class="subtitle">Historical Market Valuations: CAPE Ratio, Home Prices, and Gold</p>
        </header>

        <div class="controls">
            <div class="control-group">
                <label for="dateRange">Date Range:</label>
                <select id="dateRange">
                    <option value="british">British History (1250+)</option>
                    <option value="modern" selected>Modern History (1871+)</option>
                    <option value="100">Last 100 Years</option>
                    <option value="50">Last 50 Years</option>
                    <option value="custom">Custom Range</option>
                </select>
            </div>

            <div id="customRange" class="custom-range" style="display: none;">
                <input type="number" id="startYear" placeholder="Start Year" min="1250">
                <input type="number" id="endYear" placeholder="End Year" max="2025">
                <button id="applyRange">Apply</button>
            </div>
        </div>

        <div class="chart-config-section">
            <h2>Chart & Calculator Configuration</h2>

            <div class="compare-mode-toggle">
                <label>
                    <input type="checkbox" id="compareMode">
                    <span>Compare Multiple Assets</span>
                </label>
            </div>

            <div id="singleAssetConfig" class="asset-config">
                <h3>Display Settings</h3>
                <div class="config-row">
                    <div class="control-group">
                        <label for="asset1">Asset:</label>
                        <select id="asset1">
                            <option value="cape">CAPE Ratio</option>
                            <option value="home" selected>Home Price Index</option>
                            <option value="sp500">S&P 500</option>
                            <option value="gold">Gold</option>
                        </select>
                    </div>

                    <div class="control-group">
                        <label for="denominator1">Valued in:</label>
                        <select id="denominator1">
                            <option value="real">Real USD (Inflation-Adjusted)</option>
                            <option value="nominal">Nominal USD</option>
                            <option value="gold" selected>Gold</option>
                            <option value="home">Home Price</option>
                            <option value="sp500">S&P 500</option>
                        </select>
                    </div>

                    <div class="control-group">
                        <label for="investmentAmount">Investment ($, optional):</label>
                        <input type="number" id="investmentAmount" placeholder="Optional" min="0" step="100">
                    </div>

                </div>
            </div>

            <div id="compareConfig" class="asset-config" style="display: none;">
                <h3>Compare Multiple Assets</h3>

                <div class="compare-denominator-section">
                    <div class="control-group">
                        <label for="compareDenominator">All assets valued in:</label>
                        <select id="compareDenominator">
                            <option value="real">Real USD (Inflation-Adjusted)</option>
                            <option value="nominal">Nominal USD</option>
                            <option value="gold" selected>Gold</option>
                            <option value="home">Home Price</option>
                            <option value="sp500">S&P 500</option>
                        </select>
                    </div>
                </div>

                <div id="compareAssets">
                    <div class="compare-row" data-index="0">
                        <div class="control-group">
                            <label>Asset 1:</label>
                            <select class="compare-asset">
                                <option value="cape">CAPE Ratio</option>
                                <option value="home" selected>Home Price Index</option>
                                <option value="sp500">S&P 500</option>
                                <option value="gold">Gold</option>
                            </select>
                        </div>
                    </div>
                    <div class="compare-row" data-index="1">
                        <div class="control-group">
                            <label>Asset 2:</label>
                            <select class="compare-asset">
                                <option value="cape">CAPE Ratio</option>
                                <option value="home">Home Price Index</option>
                                <option value="sp500" selected>S&P 500</option>
                                <option value="gold">Gold</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="compare-controls">
                    <button id="addComparison" class="add-button">+ Add Asset</button>
                </div>
            </div>

            <div id="calculatorResults" class="calculator-results" style="display: none;">
                <div class="result-card">
                    <h3>Period</h3>
                    <p id="periodDates" style="font-size: 1.2em; white-space: pre-line;">-</p>
                </div>
                <div class="result-card">
                    <h3>Initial Investment</h3>
                    <p id="initialAmount">$0</p>
                </div>
                <div class="result-card">
                    <h3>Final Value</h3>
                    <p id="finalValue">$0</p>
                </div>
                <div class="result-card">
                    <h3>Total Return</h3>
                    <p id="totalReturn">$0</p>
                </div>
                <div class="result-card">
                    <h3>Return Percentage</h3>
                    <p id="returnPercentage">0%</p>
                </div>
                <div class="result-card">
                    <h3>Annualized Return</h3>
                    <p id="annualizedReturn">0%</p>
                </div>
            </div>
        </div>

        <div class="single-chart-container">
            <div class="chart-container">
                <canvas id="main-chart"></canvas>
            </div>
        </div>

        <div class="stats-panel">
            <div class="stat-card">
                <h3>Current CAPE Ratio</h3>
                <p id="currentCAPE">Loading...</p>
            </div>
            <div class="stat-card">
                <h3>Current Gold Price</h3>
                <p id="currentGold">Loading...</p>
            </div>
            <div class="stat-card">
                <h3>CAPE/Gold Ratio</h3>
                <p id="currentRatio">Loading...</p>
            </div>
            <div class="stat-card">
                <h3>Historical Percentile</h3>
                <p id="percentile">Loading...</p>
            </div>
        </div>

        <div class="info-section">
            <h2>About This Chart</h2>
            <p>
                This visualization combines Robert Shiller's CAPE (Cyclically Adjusted Price-to-Earnings) ratio
                and home price data with historical gold prices to show relative valuations over time.
                The CAPE ratio helps identify periods of stock market overvaluation or undervaluation,
                while comparing it to gold provides additional context about real value.
            </p>
            <p>
                <strong>Data Sources:</strong>
            </p>
            <ul>
                <li>Shiller Data: <a href="https://posix4e.github.io/shiller_wrapper_data/" target="_blank">Shiller Wrapper Data</a></li>
                <li>Gold Prices: <a href="https://freegoldapi.com/" target="_blank">FreeGoldAPI</a></li>
            </ul>
        </div>

        <footer>
            <p>Created with data from Robert Shiller's research and FreeGoldAPI</p>
            <p><a href="https://github.com/posix4e/shillervsgold" target="_blank" style="color: white; text-decoration: none;">⭐ View on GitHub</a> | <a href="https://github.com/posix4e/btc-mnav-rainbow" target="_blank" style="color: white; text-decoration: none;">🌈 See also: BTC Rainbow Chart</a></p>
        </footer>
    </div>

    <script src="app.js"></script>
</body>
</html>
